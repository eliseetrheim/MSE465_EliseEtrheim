
# Assignment 02: 4D-STEM Foundations  
Based on Week 02 Content (January 12–16, 2026)

---

## Overview

This assignment explores the structure and analysis of 4D-STEM datasets, with emphasis on distinguishing navigation and signal axes, performing reciprocal-space calibration, and reconstructing virtual detector images.

A 4D-STEM dataset consists of a 2D scan grid (navigation space) where a full diffraction pattern (signal space) is recorded at each probe position. Because the complete diffraction information is stored, detector signals can be defined and redefined after acquisition through virtual detector masks.

This assignment develops a structured analysis framework to:

- Normalize and verify 4D data axis ordering  
- Apply global Center of Mass (CoM) beam correction  
- Implement virtual Bright Field (BF) and Annular Dark Field (ADF) detectors  
- Compute diffraction statistics (total intensity, CoM maps, radial profiles)  
- Apply the full pipeline to a real Si/SiGe dataset  
- Generate publication-quality figures with calibrated scale bars  

---

## Virtual Detectors and “Re-Playing” the Experiment

In conventional STEM, detector geometry is physically fixed during acquisition. In contrast, 4D-STEM records the *entire diffraction pattern* at every probe position. This allows the experiment to be effectively “re-played” in software by redefining detector geometry after the fact.

Virtual detectors are software-defined masks applied to the stored diffraction patterns. By modifying the mask shape, size, or angular range, one can reconstruct different detector responses without re-collecting data.

This enables:

- Direct comparison of BF and ADF contrast from the same dataset  
- Optimization of detector geometry for specific microstructural features  
- Post-acquisition exploration of reciprocal-space scattering behavior  

### Bright Field (BF) Contrast

Virtual BF detectors collect intensity near the transmitted beam. Contrast in BF images is often dominated by diffraction contrast, strain, and phase-related effects. BF imaging is sensitive to crystal orientation and local lattice variations.

### Annular Dark Field (ADF) Contrast

Virtual ADF detectors collect high-angle scattered electrons. At sufficiently high angles, ADF intensity scales approximately with atomic number (Z), producing so-called *Z-contrast*. This makes ADF imaging particularly useful for distinguishing compositional variations, such as the Si/SiGe interface analyzed in this assignment.

---

## Repository Structure

### `assignment_02_framework.ipynb`
Primary notebook containing:

- Virtual detector definitions  
- CoM correction implementation  
- Diffraction statistics functions  
- Structured `run_pipeline()` workflow  
- Application to the Si/SiGe dataset  
- Automated generation of calibrated figures  

This notebook represents the finalized and organized analysis framework.

---

### `assignment_02_setup.ipynb`
Exploratory notebook used to:

- Inspect raw 4D-STEM datasets  
- Validate axis ordering  
- Extract calibration metadata  
- Prototype CoM correction  
- Generate preliminary visualizations  

This notebook informed the design of the structured pipeline implemented in `assignment_02_framework.ipynb`.

---

### `assignment_02_output/`
Directory containing figures generated by the analysis pipeline, including:

- Virtual BF and ADF images  
- Calibrated real-space intensity maps  
- Radial intensity profiles  
- Interface line profile plots  

All figures are saved as PNG files with descriptive titles, scale bars, and appropriate color maps. Additional plots, including those for validation of workflow, interactive plots for data exploration, and an interface line profile plot can be found in 'assignment_02_framework.ipynb'.

---

### `virtual_adf_figure_sisige.png`
A preliminary ADF figure generated during exploratory analysis in `assignment_02_setup.ipynb`.

---

## Summary

This assignment demonstrates how 4D-STEM data enables flexible, post-acquisition detector definition and structured diffraction analysis. By separating exploratory setup work from a formalized analysis pipeline, the workflow ensures reproducibility, clarity, and extensibility for future datasets.